# Проект 6. Задача кластеризации
<table>
  <tr style="vertical-align:middle">
  <tr style="vertical-align:middle">
    <!-- <th><img src = 'https://i.hh.ru/logos/svg/hh.ru__min_.svg?v=11032019'></th> -->
    <!-- <th><img style="vertical-align:middle" img src = https://lms.skillfactory.ru/static/rg-theme/images/logo-header.svg></th> -->
    <!-- <th><img style="vertical-align:middle" img src = https://static.tildacdn.com/tild3862-3932-4061-b763-363135393134/logo.svg></th> -->
    <th height=30><img style="vertical-align:middle" img src = https://static.tildacdn.com/tild3736-6663-4331-b065-623334663336/SkillFactory.svg height=20></th>
  </tr>
</table>

## Оглавление
[1. Описание проекта](#Описание-проекта)

[2. Какой кейс решаем?](#Какой-кейс-решаем)

[3. Краткая информация о данных](#Краткая-информация-о-данных)

[4. Этапы работы над проектом](#Этапы-работы-над-проектом)

[5. Результаты](#Результаты)

  > Перейти прямо к [презентации решения кейса](https://github.com/Alexey-star-boss2024/-/blob/master/PROJECT_6__Сегментация_клиентов_онлайн_магазина.ipynb)

[6. Выводы](#Выводы)  

<br>

<center> <img src=https://salesupnow.ru/storage/app/media/pipeople.png align="right" width="300"/> </center>

## Описание проекта

Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения. С появлением **[электронной коммерции](https://trends.rbc.ru/trends/industry/607fe4549a7947027eaffbe6)**, или онлайн-продаж, стало намного проще собирать данные о клиентах, анализировать их, находить закономерности и реализовывать маркетинговые кампании.

Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из *Google Analytics* или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать **[модели поведения профессиональных покупателей](http://b2bmotion.ru/b2b-pokupatel)**, определять категорию клиентов (например, лояльные/перспективные/новички/«спящие»/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

Стоит также отметить, что компании, использующие машинное обучение на своих платформах электронной коммерции, могут постоянно повышать эффективность бизнес-процессов: настраивать товарную выборку персонально для каждого покупателя и предлагать выгодную цену в соответствии с бюджетом клиента и т. д. Эта задача относится к категории построения рекомендательных систем.

> Как правило, наборы данных для электронной коммерции являются частной собственностью и, следовательно, их трудно найти среди общедоступных данных.
> 
> В **[The UCI Machine Learning Repository](http://archive.ics.uci.edu/ml/index.php)** создали набор данных, содержащий фактические транзакции за 2010 и 2011 годы. С ним как раз и предстоит поработать в этом проекте.

Датасет содержит все транзакции, произошедшие за период с 01/12/2010 по 09/12/2011, для базирующейся в Великобритании компании, занимающейся розничной онлайн-торговлей. Компания в основном продаёт уникальные подарки на все случаи жизни. Многие клиенты являются оптовиками.

<br>

### Какой кейс решаем?

**Бизнес-задача:** произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

**Техническая задача как для специалиста в Data Science:** построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

<br>

### Задачи проекта:

1. Произвести предобработку набора данных.

2. Провести разведывательный анализ данных и выявить основные закономерности.

3. Сформировать категории товаров и клиентов.

4. Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.

5. Спроектировать процесс предсказания категории интересов клиента и протестировать вашу модель на новых клиентах.

:arrow_up:[к оглавлению](#Оглавление)

<br>

**Критерии оценивания:**
**<br>Кейс «Сегментация клиентов онлайн-магазина подарков» (максимум — 18 баллов)<br>**
**<br>Знакомство со структурой данных (2 балла)<br>**
<br>
**Описание критерия	Баллы:**
<br>
<br>
Студент произвёл базовый (первичный) анализ структуры исходных данных, нашёл основные статистические характеристики признаков, привёл первичные выводы о структуре данных и их особенностях.	
- 2 балла
<br>
<br>
Студент произвёл базовый анализ исходных данных, однако первичные выводы о данных либо не приведены, либо не соответствуют действительности.	
- 1 балл 
<br>
<br>
Базовый анализ данных не произведён.
- 0 баллов
<br>
**<br>Преобразование, очистка и анализ данных (5 баллов)<br>**
**<br>Преобразование и очистка данных о транзакциях<br>**
**<br>Описание критерия	Баллы<br>**
  
**<br>Выполнены все необходимые элементы преобразования и очистки данных:<br>**
<br>-Найдены и обработаны (удалены) пропуски.<br>
<br>-Найдены и обработаны (удалены) дубликаты.<br>
<br>-Для каждой транзакции рассчитано количество возвращённого впоследствии товара.<br>
<br>-Найдены и удалены транзакции с отрицательным количеством товара.<br>
<br>-Найдены и удалены все специализированные транзакции.<br>
<br>-Найдены и удалены транзакции, в которых присутствуют бесплатные товары.<br>
<br>-Для каждой транзакции рассчитана общая стоимость товаров.<br>
<br>Примечание. Возможно наличие иных преобразований данных, не указанных в списке и обеспечивающих повышение качества итогового результата.<br>
- 2 балла
<br>Студент выполнил только важнейшую часть из заявленных преобразований данных, которая существенно влияет на итоговый результате кластеризации.<br>
- 1 балл
<br>Необходимые преобразования данных не выполнены либо выполнены некорректно.<br>
- 0 баллов
**<br> Разведывательный анализ данных о транзакциях<br>**
**<br>Описание критерия	Баллы<br>**
  
<br>Студент выполнил разведывательный анализ данных, сопроводил свои рассуждения визуализацией, привёл корректные выводы по полученным результатам и подкрепил свои выводы статистическими тестами (там, где это необходимо).<br>
-   2 балла 
<br>Студент выполнил разведывательный анализ данных, сопроводил свои рассуждения визуализацией, но сделал это формально, не дополнив визуализации выводами и рассуждениями. <br>	
-   1 балл 
<br>Студент не произвёл разведывательный анализ данных.<br>	
-   0 баллов
-   
**<br> Построение RFM-таблицы и поиск RFM-выбросов<br>**
**<br>Описание критерия	Баллы<br>**

<br>Студент корректно построил RFM-таблицу для клиентов на основе исходных данных о транзакциях, а также нашёл в ней наблюдения-выбросы и избавился от них.<br>	
-   1 балл
<br>Студент не построил RFM-таблицу или сделал это некорректно, что значительно исказило полученные в дальнейшем результаты.<br>
-   0 баллов
<br>Моделирование и оценка качества модели (7 баллов)<br>

**<br> Кластеризация на основе RFM-характеристик (проверяется только при условии, что за критерий не выставлено 0 баллов) <br>**
**<br>Описание критерия	Баллы<br>**

<br>На основе полученной RFM-таблицы студент провёл качественную сегментацию клиентов:<br>
<br>применил несколько (не менее трёх) методов кластеризации и понижения размерности;<br>
<br>произвёл разделение пользователей онлайн-магазина на сегменты, подобрал оптимальное количество кластеров;<br>
<br>выбрал оптимальный по внутренним мерам алгоритм.<br> 
-   3 балла
<br>Студент провёл сегментацию клиентов, не допустив значительных ошибок, влияющих на корректность полученных выводов, однако применил недостаточно методов кластеризации (менее трёх).<br>
<br>Либо студент провёл сегментацию клиентов, однако допустил ошибки, незначительно влияющие на корректность полученных выводов.<br>	
-   2 балла
<br>Студент провёл сегментацию клиентов, однако сделал это только формально, не сравнив несколько методов кластеризации, не подобрав оптимальное количество кластеров.<br>	
-   1 балл
<br>Студент не произвёл сегментацию клиентов или сделал это некорректно.<br>	
-   0 баллов

**<br> Интерпретация кластеров<br>**
**<br> Визуализация кластеров<br>**
**<br>Описание критерия	Баллы<br>**
<br>
Студент представил результаты кластеризации в двух- или трёхмерном пространстве и сопроводил полученные графики выводами о качестве кластеризации.
<br>	
-   2 балла
<br>
Студент представил результаты кластеризации в двух- или трёхмерном пространстве, однако сделал это только формально, не сопроводив полученные диаграммы выводами.
<br>	
-   1 балл
<br>
Студент не произвёл визуализацию кластеров.
	<br>
-   0 баллов
  
**<br> Построение профиля кластеров<br>**
**<br>Описание критерия	Баллы<br>**
 <br>
 Студент построил профили кластеров, визуализировал их в виде понятной диаграммы, а также привёл корректную интерпретацию полученных кластеров.
 <br>
-   2 балла
<br>
Студент построил профили кластеров, визуализировал их в виде понятной диаграммы, но интерпретация некоторых полученных кластеров выполнена некорректно, однако это несущественно влияет на качество решения задачи.<br>	
-   1 балл
<br>
Студент не построил профили и не проинтерпретировал кластеры, либо интерпретация некоторых полученных кластеров выполнена некорректно, и это существенно влияет на качество решения задачи.
<br>	
-   0 баллов
  
**<br>Выводы и оформление репозитория<br>**
-   2 балла
**<br>Описание критерия	Баллы<br>**
<br>Студент разместил проект в виде репозитория на GitHub, привёл описание к проекту в требуемом формате в виде файла README.md, где также указал финальные выводы по проделанной работе.<br>	
-   2 балла
<br>Студент разместил проект в виде репозитория на GitHub, привёл описание к проекту в требуемом формате в виде файла README.md, но не указал финальные выводы по проделанной работе.<br>
-   1 балл
<br>Студент разместил проект в виде репозитория на GitHub, но привёл только исходный код, без описания к нему.<br>
-   0 баллов
**<br>Оформление кода<br>**
-   2 балла
  
**<br>
Описание критерия	Баллы
<br>**
<br>Код студента чистый и понятный, оформлен по стандартам PEP-8, сопровождён комментариями и/или имеет документацию. <br>
-   2 балла
<br>Код студента содержит дублирующийся код/не сопровождён комментариями и не имеет документации, но доступен для чтения.<br>
-   1 балл
<br>Код студента содержит много дублирующегося кода, что сильно усложняет его чтение и работу/не доступен для чтения, не сопровождён комментариями и не имеет документации.<br>
-   0 баллов
  
**<br>
Максимальное количество баллов за проект — 18.
<br>**

<br>

**Что на практике:**
-   Учусь писать отличный код на Python;
-   Учусь строить оптимальные модели "декомпозиция методом главных компонент" PCA, "мягкой" EM-кластеризации GaussianMixture, "жёсткой" Kmeans-кластеризации Kmeans, агломеративной кластеризации AgglomerativeClustering;
-   Учусь сравнивать модели с точки зрения метрик, параметров;
-   Учусь следить за оптимизацией метрик модели;
-   Учусь следить за оптимизацией модели;
-   Учусь эффективно работать с Colaboratory и Visual Studio Code;
-   Повышаю квалификацию по методам преобразования и очистки данных; 
-   Повышаю квалификацию с GitHub.

:arrow_up:[к оглавлению](#Оглавление)

<br>

<br>

:arrow_up:[к оглавлению](#Оглавление)

<br>

### Этапы работы над проектом
- Ознакомление с описанием задачи;
- Знакомство с данными;
- Импортирование необходимых библиотек;
- Изучение датасета на предмет наличия пропусков и типов данных;
- Обработка данных: извлечение данных из выборки, создание новых признаков;
- Очистка и отбор признаков: преобразование и удаление признаков, на которых модель обучаться не будет, отбор признаков;
- Разделение данных для модели: выделение тестовой части, разделение тренингового датасета: 80% всех данных - на обучение, 20% данных - на валидацию, проверка размерности разделённых датасетов;
- Построение и обучение моделей;
- Сравнение и оценка целевых метрик на тестовом датасете;
- Проверка соответствия написанного кода стандарту PEP8;
- Оформление проекта.

<br>

### Результаты:

Проект c корректным выполнением кейса ["Задача кластеризации"](https://github.com/Alexey-star-boss2024/-/blob/master/PROJECT_6__Сегментация_клиентов_онлайн_магазина.ipynb).

<br>

### Выводы
В процессе выполнения кейса первоначальные данные были:
* Внимательно изучены исходные данные и проанализированы;
* Проведена подготовка данных к использованию: очистка, преобразование, исключение, создание признаков;
* Данные были исследованы на длительности поездок, выявлены зависимости, построены графики отражающие зависимости, сформированы выводы по данным;
* Построены обучающие модели, основанные на алгоритмах машинного обучения, выбраны несколько из них по максимальной целевой метрике *Accuracy*;

Для решения задачи кластеризации в данном кейсе **отлично себя показали модели**:

* <font color=LightSeaGreen>**&check;**</font> ** KMeans-алгоритм**
* <font color=LightSeaGreen>**&check;**</font> ** EM-алгоритм**
* <font color=LightSeaGreen>**&check;**</font> ** AgglomearariveClustering**
<br>


<br>

:arrow_up:[Оглавление](#Оглавление)

<br>
