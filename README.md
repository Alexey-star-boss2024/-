# Проект 6. Задача кластеризации
<table>
  <tr style="vertical-align:middle">
  <tr style="vertical-align:middle">
    <!-- <th><img src = 'https://i.hh.ru/logos/svg/hh.ru__min_.svg?v=11032019'></th> -->
    <!-- <th><img style="vertical-align:middle" img src = https://lms.skillfactory.ru/static/rg-theme/images/logo-header.svg></th> -->
    <!-- <th><img style="vertical-align:middle" img src = https://static.tildacdn.com/tild3862-3932-4061-b763-363135393134/logo.svg></th> -->
    <th height=30><img style="vertical-align:middle" img src = https://static.tildacdn.com/tild3736-6663-4331-b065-623334663336/SkillFactory.svg height=20></th>
  </tr>
</table>

## Оглавление
[1. Описание проекта](#Описание-проекта)

[2. Какой кейс решаем?](#Какой-кейс-решаем)

[3. Краткая информация о данных](#Краткая-информация-о-данных)

[4. Этапы работы над проектом](#Этапы-работы-над-проектом)

[5. Результаты](#Результаты)

  > Перейти прямо к [презентации решения кейса](https://github.com/Alexey-star-boss2024/-/blob/master/PROJECT_6__Сегментация_клиентов_онлайн_магазина.ipynb)

[6. Выводы](#Выводы)  

<br>

<center> <img src=https://salesupnow.ru/storage/app/media/pipeople.png align="right" width="300"/> </center>

## Описание проекта

Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения. С появлением **[электронной коммерции](https://trends.rbc.ru/trends/industry/607fe4549a7947027eaffbe6)**, или онлайн-продаж, стало намного проще собирать данные о клиентах, анализировать их, находить закономерности и реализовывать маркетинговые кампании.

Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из *Google Analytics* или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать **[модели поведения профессиональных покупателей](http://b2bmotion.ru/b2b-pokupatel)**, определять категорию клиентов (например, лояльные/перспективные/новички/«спящие»/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

Стоит также отметить, что компании, использующие машинное обучение на своих платформах электронной коммерции, могут постоянно повышать эффективность бизнес-процессов: настраивать товарную выборку персонально для каждого покупателя и предлагать выгодную цену в соответствии с бюджетом клиента и т. д. Эта задача относится к категории построения рекомендательных систем.

> Как правило, наборы данных для электронной коммерции являются частной собственностью и, следовательно, их трудно найти среди общедоступных данных.
> 
> В **[The UCI Machine Learning Repository](http://archive.ics.uci.edu/ml/index.php)** создали набор данных, содержащий фактические транзакции за 2010 и 2011 годы. С ним как раз и предстоит поработать в этом проекте.

Датасет содержит все транзакции, произошедшие за период с 01/12/2010 по 09/12/2011, для базирующейся в Великобритании компании, занимающейся розничной онлайн-торговлей. Компания в основном продаёт уникальные подарки на все случаи жизни. Многие клиенты являются оптовиками.

<br>

### Какой кейс решаем?

**Бизнес-задача:** произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

**Техническая задача как для специалиста в Data Science:** построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

<br>

### Задачи проекта:

1. Произвести предобработку набора данных.

2. Провести разведывательный анализ данных и выявить основные закономерности.

3. Сформировать категории товаров и клиентов.

4. Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.

5. Спроектировать процесс предсказания категории интересов клиента и протестировать вашу модель на новых клиентах.

:arrow_up:[к оглавлению](#Оглавление)

<br>

**Критерии оценивания:**
<br>Кейс «Сегментация клиентов онлайн-магазина подарков» (максимум — 18 баллов)<br>
<br>Знакомство со структурой данных (2 балла)<br>
<br>Описание критерия	Баллы<br>
<br>Студент произвёл базовый (первичный) анализ структуры исходных данных, нашёл основные статистические характеристики признаков, привёл первичные выводы о структуре данных и их особенностях.<br>	2
<br>Студент произвёл базовый анализ исходных данных, однако первичные выводы о данных либо не приведены, либо не соответствуют действительности.	1
Базовый анализ данных не произведён.<br>	0
<br>Преобразование, очистка и анализ данных (5 баллов)<br>

2.1. Преобразование и очистка данных о транзакциях
Описание критерия	Баллы
Выполнены все необходимые элементы преобразования и очистки данных:
Найдены и обработаны (удалены) пропуски.
Найдены и обработаны (удалены) дубликаты.
Для каждой транзакции рассчитано количество возвращённого впоследствии товара.
Найдены и удалены транзакции с отрицательным количеством товара.
Найдены и удалены все специализированные транзакции.
Найдены и удалены транзакции, в которых присутствуют бесплатные товары.
Для каждой транзакции рассчитана общая стоимость товаров.
Примечание. Возможно наличие иных преобразований данных, не указанных в списке и обеспечивающих повышение качества итогового результата.	2
Студент выполнил только важнейшую часть из заявленных преобразований данных, которая существенно влияет на итоговый результате кластеризации.	1
Необходимые преобразования данных не выполнены либо выполнены некорректно.	0
2.2. Разведывательный анализ данных о транзакциях
Описание критерия	Баллы
Студент выполнил разведывательный анализ данных, сопроводил свои рассуждения визуализацией, привёл корректные выводы по полученным результатам и подкрепил свои выводы статистическими тестами (там, где это необходимо).	2
Студент выполнил разведывательный анализ данных, сопроводил свои рассуждения визуализацией, но сделал это формально, не дополнив визуализации выводами и рассуждениями.	1
Студент не произвёл разведывательный анализ данных.	0
2.3. Построение RFM-таблицы и поиск RFM-выбросов
Описание критерия	Баллы
Студент корректно построил RFM-таблицу для клиентов на основе исходных данных о транзакциях, а также нашёл в ней наблюдения-выбросы и избавился от них.	1
Студент не построил RFM-таблицу или сделал это некорректно, что значительно исказило полученные в дальнейшем результаты.	0
Моделирование и оценка качества модели (7 баллов)

3.1. Кластеризация на основе RFM-характеристик (проверяется только при условии, что за критерий 2.3. не выставлено 0 баллов)
Описание критерия	Баллы
На основе полученной RFM-таблицы студент провёл качественную сегментацию клиентов:
применил несколько (не менее трёх) методов кластеризации и понижения размерности;
произвёл разделение пользователей онлайн-магазина на сегменты, подобрал оптимальное количество кластеров;
выбрал оптимальный по внутренним мерам алгоритм.
3
Студент провёл сегментацию клиентов, не допустив значительных ошибок, влияющих на корректность полученных выводов, однако применил недостаточно методов кластеризации (менее трёх).

Либо студент провёл сегментацию клиентов, однако допустил ошибки, незначительно влияющие на корректность полученных выводов.	2
Студент провёл сегментацию клиентов, однако сделал это только формально, не сравнив несколько методов кластеризации, не подобрав оптимальное количество кластеров.	1
Студент не произвёл сегментацию клиентов или сделал это некорректно.	0
3.2. Интерпретация кластеров

3.2.1. Визуализация кластеров
Описание критерия	Баллы
Студент представил результаты кластеризации в двух- или трёхмерном пространстве и сопроводил полученные графики выводами о качестве кластеризации.	2
Студент представил результаты кластеризации в двух- или трёхмерном пространстве, однако сделал это только формально, не сопроводив полученные диаграммы выводами.	1
Студент не произвёл визуализацию кластеров.	0
3.2.2. Построение профиля кластеров
Описание критерия	Баллы
Студент построил профили кластеров, визуализировал их в виде понятной диаграммы, а также привёл корректную интерпретацию полученных кластеров.	2
Студент построил профили кластеров, визуализировал их в виде понятной диаграммы, но интерпретация некоторых полученных кластеров выполнена некорректно, однако это несущественно влияет на качество решения задачи.	1
Студент не построил профили и не проинтерпретировал кластеры, либо интерпретация некоторых полученных кластеров выполнена некорректно, и это существенно влияет на качество решения задачи.	0
Выводы и оформление репозитория (2 балла)
Описание критерия	Баллы
Студент разместил проект в виде репозитория на GitHub, привёл описание к проекту в требуемом формате в виде файла README.md, где также указал финальные выводы по проделанной работе.	2
Студент разместил проект в виде репозитория на GitHub, привёл описание к проекту в требуемом формате в виде файла README.md, но не указал финальные выводы по проделанной работе.	1
Студент разместил проект в виде репозитория на GitHub, но привёл только исходный код, без описания к нему.	0
Оформление кода (2 балла)
Описание критерия	Баллы
Код студента чистый и понятный, оформлен по стандартам PEP-8, сопровождён комментариями и/или имеет документацию.	2
Код студента содержит дублирующийся код/не сопровождён комментариями и не имеет документации, но доступен для чтения.	1
Код студента содержит много дублирующегося кода, что сильно усложняет его чтение и работу/не доступен для чтения, не сопровождён комментариями и не имеет документации.	0

**Максимальное количество баллов** за проект — 18.

<br>

**Что на практике:**
-   Учусь писать отличный код на Python;
-   Учусь строить оптимальные модели "декомпозиция методом главных компонент" PCA, "мягкой" EM-кластеризации GaussianMixture, "жёсткой" Kmeans-кластеризации Kmeans, агломеративной кластеризации AgglomerativeClustering;
-   Учусь сравнивать модели с точки зрения метрик, параметров;
-   Учусь следить за оптимизацией метрик модели;
-   Учусь следить за оптимизацией модели;
-   Учусь эффективно работать с Colaboratory;
-   Повышаю квалификацию по методам преобразования и очистки данных; 
-   Повышаю квалификацию с GitHub.

:arrow_up:[к оглавлению](#Оглавление)

<br>

### Краткая информация о данных

В данном проекте первоначальные данные представлены в виде совокупного датасета размером: свыше 540 тыс. строк, 8 столбцов, типа object, float64 и int64, в отдельных столбцах присутствуют пропуски и дубликаты. По итогам обработки будут отобраны 3 признака с помощью методов уменьшения размерности, наилучшим образом подходящих для предсказания целевой переменной. В связи с этим необходимо более детально проанализировать структуру первоначальных данных, сделать выводы о дальнейших преобразованиях. Построить обучающие модели, которые должны произвести сегментацию существующих клиентов, выбрать лучшую из них.

**Датасеты**:

* ***customer_segmentation_project.csv*** содержит датасет тренировочных + валидационных данных со следующей информацией:



  * *InvoiceNo* — номер счёта-фактуры (уникальный номинальный шестизначный номер, присваиваемый каждой транзакции; буква "*C*" в начале кода указывает на отмену транзакции);
  * *Stock Code* — код товара (уникальное пятизначное целое число, присваиваемое каждому отдельному товару);
  * *Description* — название товара;
  * *Quantity* — количество каждого товара за транзакцию; 
  * *InvoiceDate* — дата и время выставления счёта/проведения транзакции;
  * *UnitPrice* — цена за единицу товара в фунтах стерлингов;
  * *CustomerID* — идентификатор клиента (уникальный пятизначный номер, однозначно присваиваемый каждому клиенту);
  * *Country* — название страны, в которой проживает клиент.

<br>

:arrow_up:[к оглавлению](#Оглавление)

<br>

### Этапы работы над проектом
- Ознакомление с описанием задачи;
- Знакомство с данными;
- Импортирование необходимых библиотек;
- Изучение датасета на предмет наличия пропусков и типов данных;
- Обработка данных: извлечение данных из выборки, создание новых признаков;
- Очистка и отбор признаков: преобразование и удаление признаков, на которых модель обучаться не будет, отбор признаков;
- Разделение данных для модели: выделение тестовой части, разделение тренингового датасета: 80% всех данных - на обучение, 20% данных - на валидацию, проверка размерности разделённых датасетов;
- Построение и обучение моделей;
- Сравнение и оценка целевых метрик на тестовом датасете;
- Проверка соответствия написанного кода стандарту PEP8;
- Оформление проекта.

<br>

### Результаты:

Проект c корректным выполнением кейса ["Задача кластеризации"](https://github.com/Alexey-star-boss2024/-/blob/master/PROJECT_6__Сегментация_клиентов_онлайн_магазина.ipynb).

<br>

### Выводы
В процессе выполнения кейса первоначальные данные были:
* Внимательно изучены исходные данные и проанализированы;
* Проведена подготовка данных к использованию: очистка, преобразование, исключение, создание признаков;
* Данные были исследованы на длительности поездок, выявлены зависимости, построены графики отражающие зависимости, сформированы выводы по данным;
* Построены обучающие модели, основанные на алгоритмах машинного обучения, выбраны несколько из них по максимальной целевой метрике *Accuracy*;

Для решения задачи кластеризации в данном кейсе **отлично себя показали модели**:

* <font color=LightSeaGreen>**&check;**</font> ** KMeans-алгоритм**
* <font color=LightSeaGreen>**&check;**</font> ** EM-алгоритм**
* <font color=LightSeaGreen>**&check;**</font> ** AgglomearariveClustering**
<br>


<br>

:arrow_up:[Оглавление](#Оглавление)

<br>
